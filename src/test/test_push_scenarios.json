[
    {
        "name": "push_new_event_blocked_event_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_event_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_event_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_event_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_attribute_tags",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked tag: tlp:red. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_event_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_event_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - object with a blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - object with a blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_event_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_attribute_distribution",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked distribution level: 0. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_event_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - object with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - object with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_category",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_category.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked category: Person. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_attribute_sharing_group",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_type",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked type: passport-number. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_type",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked type: passport-number. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_category",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_attribute_category.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked category: Person. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_category",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_attribute_category.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked category: Person. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_blocked_object_type",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - object with a blocked type: person. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_type",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - object with a blocked type: person. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_new_event_shadow_attributes_blocked_type",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_shadow_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked type: passport-number. blocked by rule: test-rule"
        ]
    },
    {
        "name": "push_edit_event_shadow_attributes_blocked_type",
        "host": "misp-external.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "event_fixture_file": "./test/fixtures/test_event_blocked_object_shadow_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked type: passport-number. blocked by rule: test-rule"
        ]
    }
]