[
    {
        "name": "push_new_event_blocked_event_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_edit_event_blocked_event_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_new_event_blocked_event_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_event_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_attribute_tags",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_tags.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked tag: tlp:red"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_edit_event_blocked_event_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_event_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_blocked_object_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - object with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - object with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_blocked_event_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_attribute_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_edit_event_blocked_event_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_new_event_blocked_object_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - object with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - object with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_category",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_category.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked category: Person"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_attribute_sharing_group",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_attribute_sharing_group.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked sharing group uuid: b9e656ba-b9c0-4506-83ed-7b54b43a57cb"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_type",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked type: passport-number"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_type",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked type: passport-number"
        ]
    },
    {
        "name": "push_new_event_blocked_object_attribute_category",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_attribute_category.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked category: Person"
        ]
    },
    {
        "name": "push_edit_event_blocked_attribute_category",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_category.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked category: Person"
        ]
    },
    {
        "name": "push_new_event_blocked_object_type",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - object with a blocked type: person"
        ]
    },
    {
        "name": "push_edit_event_blocked_object_type",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - object with a blocked type: person"
        ]
    },
    {
        "name": "push_new_event_shadow_attributes_blocked_type",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_shadow_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - attribute with a blocked type: passport-number"
        ]
    },
    {
        "name": "push_edit_event_shadow_attributes_blocked_type",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_object_shadow_attribute_type.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - attribute with a blocked type: passport-number"
        ]
    },
    {
        "name": "push_new_event_non-blocked",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_non-blocked.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_edit_event_non-blocked",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_non-blocked.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_new_event_not_allowed_compartment",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "30.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_non-blocked.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - cannot reach compartment"
        ]
    },
    {
        "name": "push_edit_event_not_allowed_compartment",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "30.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_non-blocked.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - cannot reach compartment"
        ]
    },
    {
        "name": "push_new_event_missing_required_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_required_tag.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event is missing required taxonomy: tlp"
        ]
    },
    {
        "name": "push_edit_event_missing_required_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_required_tag.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event is missing required taxonomy: tlp"
        ]
    },
    {
        "name": "push_new_event_missing_required_allowed_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_required_allowed_tag.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event is missing required taxonomy: tlp"
        ]
    },
    {
        "name": "push_edit_event_missing_required_allowed_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_required_allowed_tag.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event is missing required taxonomy: tlp"
        ]
    },
    {
        "name": "push_new_event_required_taxonomy_blocked_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_required_blocked_tag.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked tag: tlp:rainbow"
        ]
    },
    {
        "name": "push_edit_event_required_taxonomy_blocked_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_required_blocked_tag.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1 - event has blocked tag: tlp:rainbow"
        ]
    },
    {
        "name": "push_new_event_required_taxonomy_allowed_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_non-blocked_required_allowed_tag.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_edit_event_required_taxonomy_allowed_tag",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/events/edit/385283a1-b5e0-4e10-a532-dce11c365a56/metadata:1",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_non-blocked_required_allowed_tag.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_galaxy_cluster_blocked_distribution",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/galaxies/pushCluster",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_galaxy_clusters_blocked_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/galaxies/pushCluster - galaxy cluster has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_galaxy_cluster_non-blocked_distribution",
        "host": "instance1-comp1.com",
        "port": 443,
        "url": "/galaxies/pushCluster",
        "method": "POST",
        "client": {
            "ip": "40.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_galaxy_clusters_non-blocked_distribution.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_sightings_non-blocked",
        "host": "instance1-comp4.com",
        "port": 443,
        "url": "/sightings/bulkSaveSightings/5e168365-4391-44bd-851a-b48a14c30d77",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/empty.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_new_event_blocked_attribute_note_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_note_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - analyst data has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_opinion_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_opinion_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - analyst data has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_blocked_attribute_relationship_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_attribute_relationship_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - analyst data has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_analyst_notes_non-blocked",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_note_non-blocked.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_analyst_notes_blocked_distribution",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_note_blocked_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/analyst_data/pushAnalystData - analyst data has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_analyst_opinion_non-blocked",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_opinion_non-blocked.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_analyst_opinion_blocked_distribution",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_opinion_blocked_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/analyst_data/pushAnalystData - analyst data has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_analyst_relationship_non-blocked",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_relationship_non-blocked.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_analyst_relationship_blocked_distribution",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_relationship_blocked_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/analyst_data/pushAnalystData - analyst data has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_analyst_relationship_blocked_related_event_distribution",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_relationship_blocked_related_event_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/analyst_data/pushAnalystData - event has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_analyst_relationship_blocked_related_attribute_distribution",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_relationship_blocked_related_attribute_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/analyst_data/pushAnalystData - attribute with a blocked distribution level: 0"
        ]
    },
    {
        "name": "push_analyst_relationship_blocked_related_object_distribution",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/pushAnalystData",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_push_analyst_relationship_blocked_related_object_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/analyst_data/pushAnalystData - object with a blocked distribution level: 0"
        ]
    },
    {
        "name": "filter_analyst_data_for_push_non-blocked",
        "host": "instance2-comp1.com",
        "port": 443,
        "url": "/analyst_data/filterAnalystDataForPush",
        "method": "POST",
        "client": {
            "ip": "10.0.0.1",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_filter_analyst_data_for_push_non-blocked.json",
        "expected_status_code": 200,
        "expected_logs": []
    },
    {
        "name": "push_new_event_blocked_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_event_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event has blocked distribution level: 0"
        ]
    },
    {
        "name": "push_new_event_report_blocked_distribution",
        "host": "instance1-comp2.com",
        "port": 443,
        "url": "/events/add/metadata:1",
        "method": "POST",
        "client": {
            "ip": "20.0.0.2",
            "port": 22
        },
        "fixture_file": "./test/fixtures/test_event_blocked_event_report_distribution.json",
        "expected_status_code": 403,
        "expected_logs": [
            "request blocked: [POST]/events/add/metadata:1 - event report has blocked distribution level: 0"
        ]
    }
]